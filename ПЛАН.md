# План реализации учебного портала (DRF + Nuxt)

---

#### Полный план реализации учебного портала на основе требований индивидуального задания.
#### Архитектура: Django REST Framework (backend API) + Nuxt 4 (frontend SPA/SSR)

## 1. Backend (Django REST Framework)

### Модели (`models.py`):

- **User** — пользователи системы с ролями (_teacher_/_student_), расширение `AbstractUser`
- **UserProfile** — дополнительная информация о пользователе (аватар, био, контакты)
- **Course** — курсы, создаваемые преподавателями (название, описание, автор)
- **CourseEnrollment** — запись студентов на курсы (кто на какой курс записан)
- **Category** — категории курсов для фильтрации (программирование, математика и т.д.)
- **Lesson** — занятия внутри курсов (текст, дата создания, порядковый номер)
- **LessonMaterial** — файлы и материалы к занятиям (PDF, видео, презентации)
- **Assignment** — задания для студентов по каждому занятию (описание, дедлайн)
- **AssignmentFile** — дополнительные файлы к заданиям от преподавателя
- **Submission** — ответы студентов на задания (текст/ссылка, дата отправки)
- **SubmissionFile** — файлы в ответе студента (может быть несколько)
- **Grade** — оценки за выполненные задания (оценка, комментарий преподавателя)
- **Comment** — комментарии к занятиям (вопросы студентов, ответы преподавателей)
- **Notification** — уведомления для пользователей (дедлайны, оценки, комментарии)
- **Feedback** — форма обратной связи (отзывы и предложения по улучшению)
- **ActivityLog** — журнал активности пользователей (что, когда, кто сделал)

### API endpoints (ViewSets/APIViews):

```
# Аутентификация и профиль
/api/auth/register/              POST   — регистрация (роль: teacher/student)
/api/auth/login/                 POST   — получение JWT токена
/api/auth/logout/                POST   — выход (опционально)
/api/auth/refresh/               POST   — обновление токена
/api/auth/profile/               GET    — получение профиля
/api/auth/profile/               PATCH  — редактирование профиля (имя, email, аватар)

# Курсы
/api/courses/                    GET    — список курсов (фильтрация, сортировка)
/api/courses/                    POST   — создание курса (только teacher)
/api/courses/{id}/               GET    — детали курса
/api/courses/{id}/               PATCH  — редактирование курса (только teacher-автор)
/api/courses/{id}/               DELETE — удаление курса (только teacher-автор)
/api/courses/{id}/enroll/        POST   — запись студента на курс
/api/courses/{id}/students/      GET    — список студентов курса (только teacher)

# Занятия
/api/lessons/                    GET    — список занятий (фильтр по курсу)
/api/lessons/                    POST   — создание занятия (только teacher)
/api/lessons/{id}/               GET    — детали занятия
/api/lessons/{id}/               PATCH  — редактирование занятия
/api/lessons/{id}/               DELETE — удаление занятия

# Задания
/api/assignments/                GET    — список заданий (фильтр по занятию)
/api/assignments/                POST   — создание задания (только teacher)
/api/assignments/{id}/           GET    — детали задания
/api/assignments/{id}/           PATCH  — редактирование задания
/api/assignments/{id}/           DELETE — удаление задания

# Ответы студентов
/api/submissions/                GET    — список ответов (свои для student, все для teacher)
/api/submissions/                POST   — отправка ответа (только student)
/api/submissions/{id}/           GET    — детали ответа
/api/submissions/{id}/           PATCH  — редактирование ответа (до дедлайна)
/api/submissions/{id}/files/     POST   — загрузка файлов к ответу

# Оценки
/api/grades/                     GET    — список оценок
/api/grades/                     POST   — выставление оценки (только teacher)
/api/grades/{id}/                PATCH  — изменение оценки
/api/grades/{id}/                DELETE — удаление оценки

# Комментарии к занятиям
/api/comments/                   GET    — список комментариев (фильтр по занятию)
/api/comments/                   POST   — добавление комментария
/api/comments/{id}/              PATCH  — редактирование своего комментария
/api/comments/{id}/              DELETE — удаление своего комментария

# Обратная связь
/api/feedback/                   POST   — отправка отзыва/предложения
/api/feedback/                   GET    — список отзывов (только admin)

# Уведомления
/api/notifications/              GET    — список уведомлений пользователя
/api/notifications/{id}/read/    POST   — пометить как прочитанное

# Категории (для фильтрации курсов)
/api/categories/                 GET    — список категорий
```

### Пермишены (Custom Permissions):

- **IsTeacher** — только преподаватели создают курсы/задания/занятия
- **IsStudent** — только студенты отправляют ответы
- **IsOwner** — редактирование своих данных (профиль, комментарии)
- **IsCourseOwner** — только автор курса может редактировать/удалять
- **IsTeacherOrReadOnly** — преподаватель редактирует, остальные читают

### Сериализаторы:

**Основные сериализаторы для валидации:**
- `UserRegistrationSerializer` — регистрация с выбором роли (teacher/student)
- `UserProfileSerializer` — редактирование профиля (имя, email, аватар)
- `CourseSerializer` — создание/редактирование курсов
- `LessonSerializer` — создание/редактирование занятий
- `AssignmentSerializer` — создание/редактирование заданий
- `SubmissionSerializer` — отправка ответов студентами (текст + файлы)
- `GradeSerializer` — выставление оценок
- `CommentSerializer` — добавление комментариев к занятиям
- `FeedbackSerializer` — форма обратной связи

**Вложенные сериализаторы:**
- Nested serializers для отображения связанных данных (автор курса, файлы и т.д.)
- `CourseDetailSerializer` — курс со списком занятий
- `LessonDetailSerializer` — занятие с заданиями и комментариями
- `SubmissionWithFilesSerializer` — ответ с прикрепленными файлами

### Django Admin:

**Настройка админ-панели для управления данными:**
- Регистрация всех моделей в `admin.py`
- Кастомизация отображения (list_display, list_filter, search_fields)
- Inline редактирование связанных моделей (например, занятия в курсе)
- Фильтры по ролям, датам, статусам
- Возможность массовых операций (bulk actions)

### Celery + Redis:

**Фоновые задачи:**
- Email-уведомления о дедлайнах заданий (через Celery beat)
- Уведомления о новых оценках
- Уведомления о новых комментариях к занятиям
- Периодическая очистка старых уведомлений

**Celery Beat Schedule:**
- Ежедневная проверка приближающихся дедлайнов (за 1 день)
- Отправка напоминаний студентам

### Тесты:

**Django Testing Framework / pytest-django:**
- Тесты моделей (валидация, методы)
- Тесты API endpoints (CRUD операции)
- Тесты пермишенов (доступ по ролям)
- Тесты сериализаторов (валидация данных)
- Тесты Celery задач (email уведомления)

**Покрытие тестами:**
- Регистрация и авторизация
- Создание курсов (только teachers)
- Отправка ответов (только students)
- Выставление оценок (только teachers)
- Добавление комментариев
- Фильтрация и сортировка курсов

---

## 2. Frontend (Nuxt 4 + TypeScript)

### Структура страниц:

```
pages/
  index.vue                — главная страница (редирект на dashboard)

  auth/
    login.vue              — авторизация (форма входа)
    register.vue           — регистрация (выбор роли: teacher/student)

  dashboard/
    index.vue              — роутинг по ролям (redirect teacher/student)
    teacher.vue            — личный кабинет преподавателя
                              - мои курсы
                              - статистика студентов
                              - непроверенные ответы
    student.vue            — личный кабинет студента
                              - мои курсы
                              - предстоящие дедлайны
                              - последние оценки

  courses/
    index.vue              — список всех курсов
                              - фильтрация по категориям
                              - сортировка (по дате, названию)
                              - поиск по названию
    [id].vue               — детали курса
                              - описание
                              - список занятий
                              - кнопка "Записаться" (для students)
                              - управление курсом (для teacher-автора)
    create.vue             — создание курса (только для teachers)

  lessons/
    [id].vue               — страница занятия
                              - текстовое описание
                              - материалы (PDF, видео)
                              - список заданий
                              - комментарии (форма добавления)

  assignments/
    [id].vue               — страница задания
                              - описание задания
                              - дедлайн
                              - форма отправки ответа (для students)
                              - список ответов студентов (для teachers)

  profile/
    index.vue              — редактирование профиля
                              - изменение имени, email
                              - загрузка аватара
                              - изменение пароля

  feedback.vue             — форма обратной связи
                              - отправка отзывов и предложений
```

### Компоненты:

```
components/
  ui/
    Button.vue
    Input.vue
    Textarea.vue
    FileUpload.vue         — компонент загрузки файлов
    Modal.vue
    Card.vue
    Badge.vue

  forms/
    RegisterForm.vue       — форма регистрации (с выбором роли)
    LoginForm.vue          — форма авторизации
    ProfileEditForm.vue    — форма редактирования профиля
    CommentForm.vue        — форма добавления комментария к занятию
    SubmissionForm.vue     — форма загрузки ответа на задание
    FeedbackForm.vue       — форма обратной связи
    CourseForm.vue         — форма создания/редактирования курса
    LessonForm.vue         — форма создания/редактирования занятия
    AssignmentForm.vue     — форма создания/редактирования задания

  course/
    CourseCard.vue         — карточка курса в списке
    CourseFilter.vue       — фильтры для курсов
    LessonList.vue         — список занятий курса

  lesson/
    LessonContent.vue      — контент занятия
    CommentList.vue        — список комментариев
    AssignmentList.vue     — список заданий

  dashboard/
    TeacherStats.vue       — статистика для преподавателя
    StudentProgress.vue    — прогресс студента
    UpcomingDeadlines.vue  — предстоящие дедлайны
```

### Composables:

```typescript
composables/
  useAuth.ts               — авторизация, JWT токены, роли
  useApi.ts                — базовый API клиент с токенами
  useCourses.ts            — работа с курсами (CRUD)
  useLessons.ts            — работа с занятиями (CRUD)
  useAssignments.ts        — работа с заданиями (CRUD)
  useSubmissions.ts        — отправка и просмотр ответов
  useGrades.ts             — просмотр оценок
  useComments.ts           — комментарии к занятиям
  useFeedback.ts           — обратная связь
  useNotifications.ts      — уведомления
  useFileUpload.ts         — загрузка файлов (FormData)
```

### Стор (Pinia):

```typescript
stores/
  auth.ts                  — авторизация
    - user (данные пользователя)
    - role (teacher/student)
    - token (JWT)
    - isAuthenticated
    - login(), logout(), register()

  courses.ts               — курсы
    - courses (список курсов)
    - filters (категория, поиск)
    - sortBy (сортировка)
    - fetchCourses(), createCourse()

  lessons.ts               — занятия
    - lessons
    - fetchLessons(), createLesson()

  notifications.ts         — уведомления
    - notifications
    - unreadCount
    - markAsRead()
```

### Валидация форм (Zod):

```typescript
schemas/
  auth.schema.ts           — валидация регистрации/авторизации
  profile.schema.ts        — валидация редактирования профиля
  course.schema.ts         — валидация создания курса
  lesson.schema.ts         — валидация создания занятия
  assignment.schema.ts     — валидация создания задания
  comment.schema.ts        — валидация комментария
  submission.schema.ts     — валидация ответа студента
  feedback.schema.ts       — валидация обратной связи
```

### Middleware:

```typescript
middleware/
  auth.ts                  — проверка авторизации
  teacher-only.ts          — доступ только для teachers
  student-only.ts          — доступ только для students
  owner.ts                 — проверка владельца ресурса
```

### UI Framework:

- **Nuxt UI** (на основе Tailwind CSS)
- Темная/светлая тема (опционально)
- Адаптивный дизайн (мобильная версия)

### Загрузка файлов:

**Компонент FileUpload.vue:**
- Поддержка множественной загрузки
- Предпросмотр файлов
- Drag & Drop
- Отправка через FormData к API
- Отображение прогресса загрузки

---

## 3. Инфраструктура

### Docker Compose:

```
services:
  postgres:
    ...
  redis:
    ...
  backend:
    # DRF + Celery worker
  frontend:
    # Nuxt SSR/SPA
```

---

### Важное:

- CORS настройки в Django
- JWT аутентификация (`djangorestframework-simplejwt`)
- Nginx для production (статика frontend, проксирование API)
